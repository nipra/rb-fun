Code from ``Wicked Cool Ruby Scripts'' by Steve Pugh [http://techbus.safaribooksonline.com/9781593271824].
